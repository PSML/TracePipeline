ca65 V2.14.0
Main file   : oserror.s
Current file: oserror.s

000000r 1               ;
000000r 1               ; Ullrich von Bassewitz, 17.05.2000
000000r 1               ;
000000r 1               ; int __fastcall__ _osmaperrno (unsigned char oserror);
000000r 1               ;
000000r 1               
000000r 1                       .export 	__osmaperrno
000000r 1               
000000r 1                       .include	"errno.inc"
000000r 2               ;
000000r 2               ; Ullrich von Bassewitz, 16.05.2000
000000r 2               ;
000000r 2               
000000r 2               ; Variables and functions
000000r 2               
000000r 2                       .global         __errno, __oserror
000000r 2                       .global         __osmaperrno
000000r 2                       .global         __seterrno
000000r 2                       .global         __directerrno, __mappederrno
000000r 2               
000000r 2               ; Error codes, must match the values in the C headers
000000r 2               .enum
000000r 2                       EOK                     ; No error
000000r 2                       ENOENT                  ; No such file or directory
000000r 2                       ENOMEM                  ; Out of memory
000000r 2                       EACCES                  ; Permission denied
000000r 2                       ENODEV                  ; No such device
000000r 2                       EMFILE                  ; Too many open files
000000r 2                       EBUSY                   ; Device or resource busy
000000r 2                       EINVAL                  ; Invalid argument
000000r 2                       ENOSPC                  ; No space left on device
000000r 2                       EEXIST                  ; File exists
000000r 2                       EAGAIN                  ; Try again
000000r 2                       EIO                     ; I/O error
000000r 2                       EINTR                   ; Interrupted system call
000000r 2                       ENOSYS                  ; Function not implemented
000000r 2                       ESPIPE                  ; Illegal seek
000000r 2                       ERANGE                  ; Range error
000000r 2                       EBADF                   ; Bad file number
000000r 2                       EUNKNOWN                ; Unknown OS specific error - must be last!
000000r 2               
000000r 2                       EMAX    = EUNKNOWN      ; Highest error code
000000r 2               .endenum
000000r 2               
000000r 2               
000000r 2               
000000r 1               
000000r 1               __osmaperrno:
000000r 1  A2 30                ldx	#ErrTabSize
000002r 1  DD rr rr     :       cmp	ErrTab-2,x	; Search for the error code
000005r 1  F0 09                beq	:+		; Jump if found
000007r 1  CA                   dex
000008r 1  CA                   dex
000009r 1  D0 F7                bne	:-		; Next entry
00000Br 1               
00000Br 1                       ; Code not found, return EUNKNOWN
00000Br 1  A9 11                lda	#<EUNKNOWN
00000Dr 1  A2 00                ldx	#>EUNKNOWN
00000Fr 1  60                   rts
000010r 1               
000010r 1                       ; Found the code
000010r 1  BD rr rr     :       lda	ErrTab-1,x
000013r 1  A2 00                ldx	#$00		; High byte always zero
000015r 1  60                   rts
000016r 1               
000016r 1                       .rodata
000000r 1               
000000r 1  01 0D        ErrTab: .byte   $01, ENOSYS	; Bad system call number
000002r 1  04 07                .byte	$04, EINVAL	; Bad system call parameter count
000004r 1  25 02                .byte	$25, ENOMEM	; Interrupt table full
000006r 1  27 0B                .byte	$27, EIO	; I/O error
000008r 1  28 04                .byte	$28, ENODEV	; No device connected
00000Ar 1  2B 03                .byte	$2B, EACCES	; Disk write protected
00000Cr 1               ;       .byte	$2E, EUNKNOWN	; Disk switched
00000Cr 1  2F 04                .byte	$2F, ENODEV	; Device off-line
00000Er 1  40 07                .byte	$40, EINVAL	; Invalid pathname
000010r 1  42 05                .byte	$42, EMFILE	; Maximum number of files open
000012r 1  43 07                .byte	$43, EINVAL	; Invalid reference number
000014r 1  44 01                .byte	$44, ENOENT	; Directory not found
000016r 1  45 01                .byte	$45, ENOENT	; Volume not found
000018r 1  46 01                .byte	$46, ENOENT	; File not found
00001Ar 1  47 09                .byte	$47, EEXIST	; Duplicate filename
00001Cr 1  48 08                .byte	$48, ENOSPC	; Volume full
00001Er 1  49 08                .byte	$49, ENOSPC	; Volume directory full
000020r 1               ;       .byte	$4A, EUNKNOWN	; Incompatible file format
000020r 1  4B 07                .byte	$4B, EINVAL	; Unsupported storage_type
000022r 1               ;       .byte	$4C, EUNKNOWN	; End of file encountered
000022r 1  4D 0E                .byte	$4D, ESPIPE	; Position out of range
000024r 1  4E 03                .byte	$4E, EACCES	; File access error
000026r 1  50 07                .byte	$50, EINVAL	; File is open
000028r 1               ;       .byte	$51, EUNKNOWN	; Directory structure damaged
000028r 1  52 04                .byte	$52, ENODEV	; Not a ProDOS volume
00002Ar 1  53 0F                .byte	$53, ERANGE	; Invalid system call parameter
00002Cr 1  55 05                .byte	$55, EMFILE	; Volume Control Block table full
00002Er 1  56 07                .byte	$56, EINVAL	; Bad buffer address
000030r 1               ;       .byte	$57, EUNKNOWN	; Duplicate volume
000030r 1               ;       .byte	$5A, EUNKNOWN	; File structure damaged
000030r 1               
000030r 1               ErrTabSize = (* - ErrTab)
000030r 1               
