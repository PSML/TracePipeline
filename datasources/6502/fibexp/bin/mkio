#!/bin/bash

if [ $# -ne 4 ] && [ $# -ne 6 ]; then
  echo "USAGE: $0 [exp] [diff1 trace file] [initial sv file] [output file] [start sv] [end sv]"
  echo "       If [start sv] and [end sv] not specified, the entire trace is processed."
  exit 0
fi

exp=$1
trace=$2
initsv=$3
out=$4
s=0; e=0

if [ $# -eq 6 ]; then
  s=$5; e=$6
fi

~/6502/fibexp/bin/filter -o $out -s $s -e $e -t mask -m conio $trace $initsv > $out.idx 2> $out.info

echo "Created: $out | $out.idx | $out.info"
